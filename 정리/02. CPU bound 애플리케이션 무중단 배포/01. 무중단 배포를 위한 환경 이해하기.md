# 무중단 배포를 위한 환경 이해하기
## 무중단 배포란
- 말 그대로 배포를 중단 없이 진행.
- 배포(deploy)란 개발환경에서 개발된 코드를 패키징하여 서버에서 새로운 버전의 애플리케이션을 실행하도록 하는 것을 의미.

## 중단이 일어나는 상황
- 이전 버전 애플리케이션을 종료시키고, 새로운 버전 애플리케이션을 실행하고 새로운 애플리케이션이 요청을 받을 준비가 될 때까지 서비스가 중단됨. 이렇게 서비스가 중단되는 시간을 다운타임(downtime)이라 함.
- V1, V2 라고 할때, V2를 시작하기 전에 왜 V1을 내려야 할까? 이는 같은 포트를 사용하기 때문. 하나의 서버에서 하나의 포트를 동시에 서로 다른 애플리케이션이 사용되는 것은 불가능.

## 무중단 배포
- 서버만 두 개로 ㄷ늘리면 사용자는 두 서버 모두의 IP 또는 도메인 주소를 알아야 함. 그리고 두 서버중 어떤것이 배포되고 있는 지 알 수 없음.
- 애플리케이션 서버와 사용자 사이에 중계 해 줄 서버가 필요.
- 애플리케이션 서버와 사용자 사이에서 요청을 중계해 주는 서버를 '리버스 프록시(Reverse Proxy)라 함.
- 프록시는 리버스 프록시 외에도 여러가지 프록시 존재. 프록시 자체는 '대리자'라는 의미.

## 리버스 프록시로 부하 분산
- 리버스 프록시로 서버를 분산하니 트래픽도 분산할 수 있게 됨. 클라이언트는 애플리케이션 서버를 모르기 때문.
- 이렇게 트래픽을 분산해 각 서버가 받는 부하를 분산하는 것을 '로드밸런싱 (Load balancing)'이라 함.
- 대표적인 로드밸런서로 Nginx, HAProxy 존재.

## 여러가지 배포 방식
- 여러 가지 배포 방식이 있지만, 대표적으로 
	- 롤링(Rolling) 배포
	- 블루 그린(Blue Green) 배포
	- 카나리(Canary) 배포

## 트래픽이 매우 많아져도 Nginx 만으로 충분할까?
- Nginx도 결국은 서버 자원을 사용해서 동작하는 애플리케이션이기 때문에 트래픽을 무한정 받기는 불가능.
- 3가지 방안은
	- Nginx 가 실행되는 서버 Scale-up
	- 네트워크 장치로 로드 밸런싱
	- DNS 리다이렉션
- 위 3가지 방법 외에도 여러가지 방법이 있겠지만, 핵심은 '어떤 것이 현재 병목인가?' 확인하는 것. 네트워크 대역폭 자체가 병목이라면 전용 회선의 대역폭을 늘리는 방법이 필요할 수 있음.

